<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>Agorapulse Testing Libraries</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
.hidden {
    display: none;
}

.switch {
    border-width: 1px 1px 0 1px;
    border-style: solid;
    border-color: #7a2518;
    display: inline-block;
}

.switch--item {
    padding: 10px;
    background-color: #ffffff;
    color: #7a2518;
    display: inline-block;
    cursor: pointer;
}

.switch--item.selected {
    background-color: #7a2519;
    color: #ffffff;
}

</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js"></script>
<script type="text/javascript">
function addBlockSwitches() {
    $('.primary').each(function() {
        primary = $(this);
        createSwitchItem(primary, createBlockSwitch(primary)).item.addClass("selected");
        primary.children('.title').remove();
    });
    $('.secondary').each(function(idx, node) {
        secondary = $(node);
        primary = findPrimary(secondary);
        switchItem = createSwitchItem(secondary, primary.children('.switch'));
        switchItem.content.addClass('hidden');
        findPrimary(secondary).append(switchItem.content);
        secondary.remove();
    });
}

function createBlockSwitch(primary) {
    blockSwitch = $('<div class="switch"></div>');
    primary.prepend(blockSwitch);
    return blockSwitch;
}

function findPrimary(secondary) {
    candidate = secondary.prev();
    while (!candidate.is('.primary')) {
        candidate = candidate.prev();
    }
    return candidate;
}

function createSwitchItem(block, blockSwitch) {
    blockName = block.children('.title').text();
    content = block.children('.content').first().append(block.next('.colist'));
    item = $('<div class="switch--item">' + blockName + '</div>');
    item.on('click', '', content, function(e) {
        $(this).addClass('selected');
        $(this).siblings().removeClass('selected');
        e.data.siblings('.content').addClass('hidden');
        e.data.removeClass('hidden');
    });
    blockSwitch.append(item);
    return {'item': item, 'content': content};
}

$(addBlockSwitches);

</script>

</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Agorapulse Testing Libraries</h1>
<div class="details">
<span id="revnumber">version 0.2.4</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_fixt">1. Fixt</a>
<ul class="sectlevel2">
<li><a href="#_installation">1.1. Installation</a></li>
<li><a href="#_usage">1.2. Usage</a></li>
</ul>
</li>
<li><a href="#_office_unit">2. Office Unit</a>
<ul class="sectlevel2">
<li><a href="#_installation_2">2.1. Installation</a></li>
<li><a href="#_usage_2">2.2. Usage</a></li>
</ul>
</li>
<li><a href="#_spock">3. Spock</a>
<ul class="sectlevel2">
<li><a href="#_installation_3">3.1. Installation</a></li>
<li><a href="#_usage_3">3.2. Usage</a></li>
</ul>
</li>
<li><a href="#_maintained_by">4. Maintained by</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="openblock">
<div class="content">
<div class="imageblock left">
<div class="content">
<a class="image" href="https://search.maven.org/search?q=g:%22com.agorapulse.testing%22%20AND%20a:%22fixt%22"><img src="https://img.shields.io/maven-central/v/com.agorapulse.testing/fixt.svg?label=Maven%20Central" alt="fixt"></a>
</div>
</div>
<div class="imageblock left">
<div class="content">
<a class="image" href="https://travis-ci.org/agorapulse/testing-libraries"><img src="https://travis-ci.org/agorapulse/testing-libraries.svg?branch=master" alt="Build Status"></a>
</div>
</div>
<div class="imageblock left">
<div class="content">
<a class="image" href="https://coveralls.io/github/agorapulse/testing-libraries?branch=master""><img src="https://coveralls.io/repos/github/agorapulse/testing-libraries/badge.svg?branch=master" alt="badge"></a>
</div>
</div>
</div>
</div>
<hr>
<div class="paragraph">
<p>Set of useful test utilities. All the libraries are available in <a href="https://bintray.com/bintray/jcenter">JCenter Maven repository</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fixt"><a class="anchor" href="#_fixt"></a>1. Fixt</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Fixt helps organize fixtures for your fixtures in a directories with the same name as your test class.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/fixt.png" alt="fixt">
</div>
</div>
<div class="paragraph">
<p>Given a test residing in <code>src/test/java</code> or <code>src/test/groovy</code> with name <code>org.example.MyTest</code> then
the fixtures' location will <code>src/test/resources/org/example/MyTest</code> keeping all the files for given test in a single folder.</p>
</div>
<div class="paragraph">
<p>If you generate the fixture files from your tests it is always better to specify the path to the test resources folder
using <code>test.resources.folder</code> system property or <code>TEST_RESOURCES_FOLDER</code> environment variable.</p>
</div>
<div class="paragraph">
<p>In Gradle, you can easily achive this by using following snippet:</p>
</div>
<div class="listingblock">
<div class="title">Setting Test Resources Folder in Gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="groovy">test {
    environment 'TEST_RESOURCES_FOLDER', new File(project.projectDir, 'src/test/resources').canonicalPath
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Fixt guarantee that the directories are created before the test run so adding new fixture files will be easier.</p>
</div>
<div class="sect2">
<h3 id="_installation"><a class="anchor" href="#_installation"></a>1.1. Installation</h3>
<div class="listingblock primary">
<div class="title">Gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code>repositories {
    mavenCentral()
}

dependencies {
    testCompile 'com.agorapulse.testing:fixt:0.2.4'
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Maven</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.agorapulse.testing&lt;/groupId&gt;
    &lt;artifactId&gt;fixt&lt;/artifactId&gt;
    &lt;version&gt;0.2.4&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_usage"><a class="anchor" href="#_usage"></a>1.2. Usage</h3>
<div class="listingblock">
<div class="title">Example Specification</div>
<div class="content">
<pre class="prettyprint highlight nowrap"><code data-lang="groovy">package com.agorapulse.testing.fixt

import org.junit.Rule
import org.junit.rules.TemporaryFolder
import spock.lang.Specification
import spock.util.environment.RestoreSystemProperties

@RestoreSystemProperties
class FixtSpec extends Specification {

    public static final String TEXT_FILE = 'text.txt'
    public static final String TEXT_CONTENT = 'Hello Text\n'
    public static final String STREAM_FILE = 'stream.txt'
    public static final String STREAM_CONTENT = 'Hello Stream\n'
    public static final String EMPTY_FILE = 'empty.txt'
    public static final String EMPTY_CONTENT = ''

    @Rule
    TemporaryFolder tmp = new TemporaryFolder()

    Fixt fixt = Fixt.create(this)                                                       <i class="conum" data-value="1"></i><b>(1)</b>

    void 'reading existing files'() {
        expect:
            fixt.readStream(STREAM_FILE).text == STREAM_CONTENT                         <i class="conum" data-value="2"></i><b>(2)</b>
            fixt.readText(TEXT_FILE) == TEXT_CONTENT                                    <i class="conum" data-value="3"></i><b>(3)</b>
            fixt.readText(EMPTY_FILE) == EMPTY_CONTENT
    }

    void 'writing files'() {
        when:
            Fixt fixt = Fixt.create(ReferenceClass)                                     <i class="conum" data-value="4"></i><b>(4)</b>
            File testResources = tmp.newFolder()

            System.setProperty('test.resources.folder', testResources.canonicalPath)

            fixt.mkdirs()                                                               <i class="conum" data-value="5"></i><b>(5)</b>
        then:
            Fixt.testResourcesLocation == testResources.canonicalPath

        when:
            ByteArrayInputStream stream = new ByteArrayInputStream(STREAM_CONTENT.bytes)
            fixt.writeStream(STREAM_FILE, stream)                                       <i class="conum" data-value="6"></i><b>(6)</b>
            fixt.writeText(TEXT_FILE, TEXT_CONTENT)                                     <i class="conum" data-value="7"></i><b>(7)</b>

            File contextTestFolder = new File(testResources, 'com/agorapulse/testing/fixt/ReferenceClass')
        then:
            contextTestFolder.exists()
            new File(contextTestFolder, STREAM_FILE).text == STREAM_CONTENT
            new File(contextTestFolder, TEXT_FILE).text == TEXT_CONTENT
    }

    void 'copy directory'() {
        given:
            Fixt fixt = Fixt.create(this)
            File destinationDir = tmp.newFolder()
        when:
            fixt.copyTo('testdir', destinationDir)                                      <i class="conum" data-value="8"></i><b>(8)</b>
        then:
            new File(destinationDir, 'root.txt').exists()                               <i class="conum" data-value="9"></i><b>(9)</b>
            new File(destinationDir, 'firstLevel/firstLevel.txt').exists()
            new File(destinationDir, 'firstLevel/secondLevel/secondLevel.txt').exists()
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Declare <code>Fixt</code> for the specification</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Read the content of the file as stream</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Read the content of the file as text</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Create <code>Fixt</code> for the specific class (<code>ReferenceClass</code>)</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Create all necessary directories if they do not exist yet</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Write the content of the stream into a file</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Write the text into a file</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Copy whole directory from the test resources</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>All thehe files from the fixture directory are available in the new destination</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_office_unit"><a class="anchor" href="#_office_unit"></a>2. Office Unit</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Office Unit is trivial tool for matching Microsoft Office documents. It leverage their nature of
being archive files with XML content. It compares the content of the files using <a href="https://www.xmlunit.org/">XmlUnit</a>
but it by default ignores date created and last updated timestamps. The typical usecase is to compare the
reference file against the newly generated to keep the status quo of the exports.</p>
</div>
<div class="paragraph">
<p>For Excel documents, you should consider using <a href="http://spreadsheet.dsl.builders/#_reading_and_querying_spreadsheets">SpreadsheetQuery</a>
instead.</p>
</div>
<div class="sect2">
<h3 id="_installation_2"><a class="anchor" href="#_installation_2"></a>2.1. Installation</h3>
<div class="listingblock primary">
<div class="title">Gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code>repositories {
    mavenCentral()
}

dependencies {
    testCompile 'com.agorapulse.testing:office-unit:0.2.4'
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Maven</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.agorapulse.testing&lt;/groupId&gt;
    &lt;artifactId&gt;office-unit&lt;/artifactId&gt;
    &lt;version&gt;0.2.4&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_usage_2"><a class="anchor" href="#_usage_2"></a>2.2. Usage</h3>
<div class="listingblock">
<div class="title">Example Specification</div>
<div class="content">
<pre class="prettyprint highlight nowrap"><code data-lang="groovy">void 'no differences: #control with #test'() {
    expect:
        new OfficeUnit().compare(                                                   <i class="conum" data-value="1"></i><b>(1)</b>
            loadFile(control),
            loadFile(test)
        ).empty
    where:
        control         | test
        'test1.pptx'    | 'test2.pptx'
        'test1.xlsx'    | 'test2.xlsx'
}

void '#differencesCount difference(s): #control with #test'() {
    given:
        OfficeUnit officeUnit = new OfficeUnit()
    expect:
        officeUnit.compare(                                                         <i class="conum" data-value="2"></i><b>(2)</b>
                loadFile(control),
                loadFile(test)
        ).size() == differencesCount
    where:
        control         | test              | differencesCount
        'test1.xlsx'    | 'test3.xlsx'      | 1
        'test1.xlsx'    | 'test4.xlsx'      | 8
        'test1.xlsx'    | 'test5.xlsx'      | 159
        'test1.pptx'    | 'test3.pptx'      | 2469
}

void 'ignore some other part'() {
    given:
        OfficeUnit officeUnit = new OfficeUnit()
            .ignore('/sst[1]/si[3]/t[1]/text()[1]')                                 <i class="conum" data-value="3"></i><b>(3)</b>
    expect:
        officeUnit.compare(
            loadFile('test1.xlsx'),
            loadFile('test3.xlsx')
        ).empty
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Compare two Microsoft Office files and expect no difference</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Expect some differences</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Ignore some differences by XPath expression</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_spock"><a class="anchor" href="#_spock"></a>3. Spock</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Set of useful <a href="http://spockframework.org/">Spock Framework</a> extensions.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@Detached</code> will automatically attach mock created by <code>DetachedMockFactory</code></p>
</li>
<li>
<p><code>@OverrideParentFeatures</code> will override any parent features of the same name</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_installation_3"><a class="anchor" href="#_installation_3"></a>3.1. Installation</h3>
<div class="listingblock primary">
<div class="title">Gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code>repositories {
    mavenCentral()
}

dependencies {
    testCompile 'com.agorapulse.testing:spock:0.2.4'
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Maven</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.agorapulse.testing&lt;/groupId&gt;
    &lt;artifactId&gt;spock&lt;/artifactId&gt;
    &lt;version&gt;0.2.4&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_usage_3"><a class="anchor" href="#_usage_3"></a>3.2. Usage</h3>
<div class="listingblock">
<div class="title">Detached Specification</div>
<div class="content">
<pre class="prettyprint highlight nowrap"><code data-lang="groovy">package com.agorapulse.testing.spock

import spock.lang.Specification

class DetachedSpec extends Specification {

    @Detached Runnable runnable = MyMockFactory.mockRunnable()                          <i class="conum" data-value="1"></i><b>(1)</b>

    void 'mock is attached'() {
        when:
            runnable.run()
        then:
            1 * runnable.run()
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>You can attach mock which has been created out of the scope of current specification</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Parent Specification</div>
<div class="content">
<pre class="prettyprint highlight nowrap"><code data-lang="groovy">package com.agorapulse.testing.spock

import spock.lang.Specification

class ParentSpec extends Specification {

    void 'ignore me in child'() {                                                       <i class="conum" data-value="1"></i><b>(1)</b>
        expect:
            this.getClass() == ParentSpec || this.getClass() == GrandChildSpec
    }

    void 'ignore me in grandchild'() {
        expect:
            this.getClass() == ParentSpec || this.getClass() == ChildSpec
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Feature methods declared in parent specification cannot be normally overriden</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Child Specification</div>
<div class="content">
<pre class="prettyprint highlight nowrap"><code data-lang="groovy">package com.agorapulse.testing.spock

class ChildSpec extends ParentSpec {

    @OverrideParentFeatures                                                             <i class="conum" data-value="1"></i><b>(1)</b>
    void 'ignore me in child'() {
        expect:
            this.getClass() == ChildSpec || this.getClass() == GrandChildSpec
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Using <code>OverrideParentFeatures</code> any method with the same name in any parent is skipped</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_maintained_by"><a class="anchor" href="#_maintained_by"></a>4. Maintained by</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<a class="image" href="https://www.agorapulse.com/"><img src="https://cloud.githubusercontent.com/assets/139017/17053391/4a44735a-5034-11e6-8e72-9f4b7139d7e0.png" alt="4a44735a 5034 11e6 8e72 9f4b7139d7e0"></a>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 0.2.4<br>
Last updated 2025-07-29 11:27:34 UTC
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.min.js"></script>
</body>
</html>